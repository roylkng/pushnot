function guid(){function n(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()}var _connecto=_connecto||[];_connecto.getConnectoStorage=function(){var n=localStorage.getItem("_Connecto");if(n)try{return JSON.parse(n)}catch(o){return{}}return null},_connecto.initConnectoStorage=function(){if(localStorage.getItem("_Connecto"))return _connecto.getConnectoStorage();var n={source:document.referrer,landing_page:document.URL,firstVisitOn:new Date};return localStorage.setItem("_Connecto",JSON.stringify(n)),n},_connecto.saveToConnectoStorage=function(n,o){var e=_connecto.getConnectoStorage();e||(e=_connecto.initConnectoStorage()),e[n]=o,localStorage.setItem("_Connecto",JSON.stringify(e))},_connecto.getFromConnectoStorage=function(n){var o=_connecto.getConnectoStorage();return o&&o[n]?o[n]:null},_connecto.removeFromConnectoStorage=function(n){var o=_connecto.getConnectoStorage();o&&o[n]&&delete o[n],localStorage.setItem("_Connecto",JSON.stringify(o))},_connecto.getAnonymousId=function(){var n=_connecto.getFromConnectoStorage("anonymousId");return n},_connecto.getDefaultPayload=function(n,o){var e=_connecto.getAnonymousId(),t=_connecto.getFromConnectoStorage("userId"),c=o||new Date,r={messageId:guid(),type:n,userId:t,anonymousId:e,timestamp:c,context:{url:document.location.href,library:{name:"connecto.js",version:"1.0"}},writeKey:_connecto.writeKey,channel:"web"};return r},_connecto.ajax=function(n){var o=n.url,e=n.type||"POST",t=n.dataType||"text/plain",c=n.withCredentials||!0,r=n.success,a=n.data||null,s=n.headers,i=new XMLHttpRequest;i.open(e,o,!0),i.setRequestHeader("content-type",t);for(var u in s)i.setRequestHeader(u,s[u]);i.withCredentials=c,i.onreadystatechange=function(){r&&4==this.readyState&&200==this.status&&r(this.responseText)},a?i.send(JSON.stringify(a)):i.send()},_connecto._sendIdentifyToServer=function(n,o){var e=_connecto.getIdentity(),t=_connecto._checkProfileTraits(o),c=!0;return e&&n&&n==e&&(void 0!=o&&t||(c=!1)),c},_connecto._checkProfileTraits=function(n){var o=_connecto.getFromConnectoStorage("lastTraits"),e=!1;return JSON.stringify(n)!=JSON.stringify(o)&&(e=!0),e},_connecto.identify=function(n,o,e){var t=new Date,c=_connecto._sendIdentifyToServer(n,o);if(!c)return void(e&&e());n&&_connecto.saveToConnectoStorage("userId",n),_connecto.saveToConnectoStorage("lastTraits",o);var r=_connecto.getDefaultPayload("identify",t);r.traits=o;var a=document.location.protocol+"//api.connecto.io/identify";null!==r.anonymousId?_connecto._sendAndProcessResponse(a,r,e):_connecto._sendAndProcessResponse(a,r,e,_connecto.cbToSetAnonymousId)},_connecto._sendAndProcessResponse=function(n,o,e,t){var c=function(n){res=JSON.parse(n),t&&t(res),e&&e()};o.sentAt=new Date,_connecto.ajax({url:n,data:o,success:c})},_connecto.cbToSetAnonymousId=function(n){if(n.anonymousId){var o=n.anonymousId;_connecto.initConnectoStorage(),_connecto.saveToConnectoStorage("anonymousId",o)}},_connecto.track=function(n,o,e){var t=_connecto.getDefaultPayload("track",new Date);t.event=n,t.properties=o;var c=document.location.protocol+"//api.connecto.io/track";null!==t.anonymousId?_connecto._sendAndProcessResponse(c,t,e):_connecto._sendAndProcessResponse(c,t,e,_connecto.cbToSetAnonymousId)},_connecto.page=function(n,o){var e=_connecto.getDefaultPayload("page",new Date);n&&(e.data=n);var t=document.location.protocol+"//api.connecto.io/page";null!==e.anonymousId?_connecto._sendAndProcessResponse(t,e,o):_connecto._sendAndProcessResponse(t,e,o,_connecto.cbToSetAnonymousId)},_connecto.onload=function(n){n&&n()},_connecto.processOnLoad=function(){for(var n=_connecto.length,o=0;n>o;o++)_connecto._processPushedFunction(_connecto.shift())},_connecto._processPushedFunction=function(n){var o=n.shift();_connecto[o]&&_connecto[o].apply(null,n)},_connecto.push=function(n){_connecto._processPushedFunction(n)},_connecto.getIdentity=function(){var n=_connecto.getFromConnectoStorage("userId");return n||(n=_connecto.getAnonymousId()),n},function(){if(_connecto.initialized)return void(window.console&&console.error&&console.error("Connecto Snippet Included Twice"));_connecto.initialized=!0,_connecto.processOnLoad();var n=_connecto.getFromConnectoStorage("anonymousId");n||_connecto.initConnectoStorage()}();